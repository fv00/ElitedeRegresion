library(RcmdrMisc)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999)
clientes = (1:25)*30
h.clientes = c(1,1,2,2,4,4,6,7,7,6,6,5,5,4,3,2,2,2,2,2,1,1,1,1,1)
h.clientes = ifelse(h.clientes == 1,1,h.clientes*2)
plot(clientes,h.clientes,xlab = 'Clientes Mensuales')
lines(clientes,h.clientes)
grid()
set.seed(444)
prob.clientes = h.clientes/sum(h.clientes)
muestra = sample(clientes,10000,replace=T,prob=prob.clientes)
plot(density(muestra,bw=40),main = 'Densidad de la variable # de clientes en un mes')
abline(v = 267,lty = 3)
grid()
library(MASS)
ajuste_clientes <- fitdistr(muestra,'gamma')
kable(t(ajuste_clientes$estimate))
mus = seq(1*30,28*30,length=10000)
alturas = dgamma(mus,shape =  4.6582606272  ,rate = 0.0143067422)
plot(density(muestra,bw=40),main = 'Densidad de la variable # de clientes en un mes')
points(mus,alturas,type='l',col='red')
grid()
kable(numSummary(muestra, statistics=c("min","mean", "sd", "quantiles"))$table)
library(hdrcde)
set.seed(444)
kable(hdr(muestra,prob = c(50,95,99))$hdr)
valores = c(9, 10, 12, 15 , 20)
frecuencias = c(5,15,55,25,5)
plot(valores, frecuencias, main = "Valores Elicitados en las muestras hipotéticas", ylab = "Frecuencia de los valores", xlab = "Ingreso por servicio")
lines(valores, frecuencias)
grid()
set.seed(444)
nSim = 10000
nSeguridad =  6
medias <- apply(matrix(sample(valores, nSim*nSeguridad,
replace = T, prob = frecuencias), ncol = nSeguridad),1, mean)
hist(medias, freq=F,main = 'Histograma para el ingreso promedio por servicio', xlab = "Ingreso promedio por servicio")
plot(density(medias, bw= 0.21),main = 'Densidad del ingreso por servicio')
grid()
ajuste_ingreso <- fitdistr(medias, 'gamma')
kable(t(ajuste_ingreso$estimate))
plot(density(medias, bw= 0.21),main = 'Densidad del ingreso por servicio')
rango_precios <- seq(9, 25, by = 0.1)
valores_gamma <- dgamma(rango_precios, shape =163.6701069 , rate =12.9190670  )
points(rango_precios,valores_gamma,type='l',col='red')
kable(numSummary(medias, statistics=c("min","mean", "sd", "quantiles"))$table)
set.seed(444)
kable(hdr(medias,prob = c(50,95,99))$hdr)
cantidades <- seq(5.4, 6.8, by= 0.1)
alturas <- c(0.05, 0.15, 0.15, 0.25, 0.35, 0.35, 0.35, 0.5, 0.35, 0.35, 0.25, 0.25, 0.25, 0.15, 0.05)*100
prob.barberos = alturas/sum(alturas)
plot(cantidades, alturas,xlab = 'Cantidad de barberos en miles')
lines(cantidades, alturas)
set.seed(444)
muestras_cantidades = sample(cantidades,10000,replace=T,prob=prob.barberos)
plot(density(muestras_cantidades, bw=0.2),
main = "Densidad de la variable cantidad de barberos \n en Medellín")
kable(numSummary(muestras_cantidades, statistics=c("min","mean", "sd", "quantiles"))$table)
set.seed(444)
estimaciones <- hdr(muestras_cantidades, prob = c(50,95,99))
kable(estimaciones$hdr)
ingreso_barbero <- muestra*medias
hist(ingreso_barbero,main = 'histograma para el ingreso mensual por barbero \n (en miles de pesos)', xlab="Ingreso total por barbero")
plot(density(ingreso_barbero),main = 'Dendidad para el ingreso mensual por barbero \n (en miles de pesos)')
grid()
kable(numSummary(ingreso_barbero, statistics=c("min","mean", "sd", "quantiles"))$table)
set.seed(444)
kable(hdr(ingreso_barbero)$hdr)
ingreso_barberos <- muestras_cantidades*medias*muestra*1000*1000
hist(ingreso_barberos,main = 'Histograma para el ingreso total de barberos', xlab = "Ingreso total de los barberos")
plot(density(ingreso_barberos),main = 'Densidad del ingreso total de \n los barberos en Medellín')
grid()
kable(numSummary(ingreso_barberos, statistics=c("min","mean", "sd", "quantiles"))$table)
set.seed(444)
kable(hdr(ingreso_barberos)$hdr)
estimaciones$falpha
kable(estimaciones$falpha)
estimaciones
estimaciones$mode
kable(estimaciones$mode)
library(plotrix)
library(plotrix)
library(knitr)
library(GGally)
library(ggplot2)
datos <- read.table("APC1modifm3.csv", header = T, sep = ";", dec = ",",
colClasses = c(rep("numeric",7),"factor",rep("numeric",3),"factor"))
